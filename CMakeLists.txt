cmake_minimum_required(VERSION 3.10)
project(SanskritTamilNLP)

set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

# ----------------------------------
# Collect source files
# ----------------------------------
file(GLOB_RECURSE ENGINE_SRC
    src/engine/*.cpp
    src/core/*.cpp
    src/grammar/*.cpp
    src/phoneme/*.cpp
)

# ----------------------------------
# Main application
# ----------------------------------
add_executable(SanskritTamilNLP
    src/main.cpp
    ${ENGINE_SRC}
)

target_include_directories(SanskritTamilNLP PRIVATE src)

# ----------------------------------
# Unit test executable
# ----------------------------------
add_executable(SanskritTamilNLP_Test
    src/test.cpp
    ${ENGINE_SRC}
)

target_include_directories(SanskritTamilNLP_Test PRIVATE src)



Good catch üëå ‚Äî this is **expected behavior**, not an error.
Let me explain it **clearly and simply**.

---

## Why it builds ‚Äútwo times‚Äù

You defined **TWO executables** in CMake:

1. **`SanskritTamilNLP`** ‚Üí your main program
2. **`SanskritTamilNLP_Test`** ‚Üí your unit tests

Both of them use the **same source files**:

```
core/*.cpp
engine/*.cpp
grammar/*.cpp
phoneme/*.cpp
```

### What CMake must do

CMake **cannot reuse object files between executables** by default.

So it does this:

* Compile sources ‚Üí for **main executable**
* Compile the same sources again ‚Üí for **test executable**
* Link each separately

That‚Äôs why you see:

```
GrammarRule.cpp.o   (for main)
GrammarRule.cpp.o   (for test)
```

Same code ‚Üí different targets ‚Üí built twice.

‚úî This is **normal**
‚úî This is **correct**
‚úî This is **safe**

---

## How to confirm (mental model)

Think like this:

> One engine, two cars
> Each car needs its own engine copy

---

## ‚úÖ BEST PRACTICE (fix double compilation)

Turn shared code into a **library**, then link it.

### Clean architecture

```
[ core / engine / grammar / phoneme ] ‚Üí libSanskritEngine.a
                         ‚Üò            ‚Üô
                    main app      unit test
```

---

## üîß Improved CMake (library-based)

```cmake
cmake_minimum_required(VERSION 3.10)
project(SanskritTamilNLP)

set(CMAKE_CXX_STANDARD 17)
set(CMAKE_CXX_STANDARD_REQUIRED ON)

# ----------------------------------
# Shared library
# ----------------------------------
file(GLOB_RECURSE ENGINE_SRC
    src/core/*.cpp
    src/engine/*.cpp
    src/grammar/*.cpp
    src/phoneme/*.cpp
)

add_library(SanskritEngine STATIC ${ENGINE_SRC})
target_include_directories(SanskritEngine PUBLIC src)

# ----------------------------------
# Main executable
# ----------------------------------
add_executable(SanskritTamilNLP src/main.cpp)
target_link_libraries(SanskritTamilNLP SanskritEngine)

# ----------------------------------
# Test executable
# ----------------------------------
add_executable(SanskritTamilNLP_Test src/test.cpp)
target_link_libraries(SanskritTamilNLP_Test SanskritEngine)
```

---

## What changes now

* Shared code compiles **ONCE**
* Faster builds
* Cleaner dependency graph
* Professional CMake layout

---

## When double-build is OK

* Small projects
* Early prototypes
* Few source files

## When library is better

* Growing project (you are here ‚úÖ)
* Tests
* CI/CD
* Future reuse

---

If you want next:

* `ctest` integration
* install/export library
* split grammar vs phoneme libs
* performance flags

Just say it üëç
